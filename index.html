<!DOCTYPE html>
<html>

<head>
    <title>Snakey Snake</title>
    <script src="./snake.js"></script>
    <script src="./utils.js"></script>
    <style>
        body {
            overflow: hidden;
            margin: 0;
            padding: 0
        }
    </style>
</head>

<body>
    <canvas id="snakeboard"></canvas>
</body>

<script>
    const board_border = 'GhostWhite';
    const board_background = "LavenderBlush";

    const snakeboard = document.getElementById("snakeboard");
    const snakeboard_ctx = snakeboard.getContext("2d");
    snakeboard.width = window.innerWidth;
    snakeboard.height = window.innerHeight;

    const middle_y = snakeboard.height / 2;

    let snake = new Snake(snakeboard_ctx, [
        { x: 240, y: middle_y },
        { x: 220, y: middle_y },
        { x: 200, y: middle_y },
        { x: 180, y: middle_y },
        { x: 160, y: middle_y }
    ]);

    document.addEventListener("keydown", keyboardControl);

    main();

    function main() {
        resetCanvas();
        snake.init();
        autoMove();
    }

    function resetCanvas() {
        //  Select the colour to fill the drawing
        snakeboard_ctx.fillStyle = board_background;
        // Draw a "filled" rectangle to cover the entire canvas
        snakeboard_ctx.fillRect(0, 0, snakeboard.width, snakeboard.height);
        // Draw a "border" around the entire canvas
        snakeboard_ctx.lineWidth = 10;
        snakeboard_ctx.strokeStyle = board_border;
        snakeboard_ctx.strokeRect(0, 0, snakeboard.width, snakeboard.height);
    }

    function autoMove() {
        setTimeout(function onTick() {
            resetCanvas();
            snake.move();
            // Call main again
            main();
        }, 100)
    }

    function keyboardControl(event) {
        const KEY_LEFT = 37;
        const KEY_RIGHT = 39;
        const KEY_SPACE = 32;

        const keyPressed = event.keyCode;

        if (keyPressed === KEY_LEFT) {
            snake.turnLeft();
        }
        if (keyPressed === KEY_RIGHT) {
            snake.turnRight();
        }
        if (keyPressed === KEY_SPACE) {
            snake.pauseOrResumeMoving();
        }
    }

</script>

</html>